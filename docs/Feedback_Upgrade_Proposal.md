# 🚀 피드백 시스템 업그레이드 제안 (Feedback System Upgrade Proposal)
> **목표**: "RLHF Lite" (리커트 척도)에서 "RLHF Pro" (댓글 기반 & 의미론적)으로 업그레이드.

현재 시스템은 긍정/부정 예시를 찾기 위해 **키워드 매칭**을 사용합니다. 이를 **벡터 임베딩**과 **사용자 댓글**을 사용하여 더 정확하고 유익한 피드백을 제공하도록 업그레이드하는 것을 제안합니다.

---

## 💡 핵심 개념: 댓글 기반 지침 (Comment-based Instruction)
단순히 답변이 나쁘다는 것을 아는 것 이상으로, *왜* 나쁜지, 그리고 사용자 댓글을 기반으로 AI에게 *어떻게 고쳐야 하는지* 알려주고자 합니다.

**현재 (Current)**:
> "다음은 나쁜 예시입니다: [답변]" (AI는 무엇이 잘못되었는지 추측해야 함)

**목표 (Target)**:
> "사용자가 이 답변에 대해 다음과 같이 언급했습니다: '너무 길고 복잡함'. 장황하게 설명하는 것을 피하세요." (명시적 지침)

---

## 📋 제안된 접근 방식 (Proposed Approaches)

### 옵션 1: 의미론적 피드백 검색 (벡터 검색)
**"AI 이해를 활용하여 더 나은 예시 찾기"**

-   **메커니즘**: `sentence-transformers`와 `FAISS` (requirements.txt에 이미 포함됨)를 사용하여 사용자 질문과 피드백을 벡터로 변환합니다.
-   **이점**: 키워드가 정확히 일치하지 않더라도 관련 피드백을 찾습니다 (예: "비용" vs "요금").
-   **구현**:
    1.  사용자 질문을 임베딩(Vectorize)합니다.
    2.  벡터 DB에서 유사한 과거 피드백을 검색합니다.
    3.  상위 3개의 관련 피드백 항목을 프롬프트에 주입합니다.

### 옵션 2: 능동적 지침 튜닝 (댓글 기반)
**"사용자 댓글을 규칙으로 직접 사용"**

-   **메커니즘**: "나쁨(Bad)" 피드백을 검색할 때, **댓글(Comment)**이 있는지 확인합니다.
-   **동작**: 댓글이 존재하면 특정 제약 조건으로 주입합니다.
-   **프롬프트 예시**:
    ```text
    ⚠️ 이 주제에 대한 이전 사용자 불만 사항:
    - "마크다운 형식을 사용하지 마세요."
    - "포털 링크를 제공해 주세요."
    ```
    - **이점**: AI는 피해야 할 것과 포함해야 할 것에 대한 명시적인 지침을 받습니다.

### 옵션 3: "골든 답변" 퓨샷 러닝 (Few-Shot Learning)
**"사용자 수정을 통한 학습"**

-   **메커니즘**: 사용자가 댓글 필드(또는 별도 필드)에 "정답(Correct Answer)"을 제공할 수 있도록 합니다.
-   **동작**: 이를 프롬프트에서 "골든 예시(Golden Examples)"로 사용합니다.
-   **프롬프트 예시**:
    ```text
    ✅ 사용자가 제안한 더 나은 답변:
    "등록금은 RM 20,000입니다."
    ```
    - **이점**: 사실적 오류를 직접 수정합니다.

---

## 🏆 권장 사항: 하이브리드 접근 방식 (옵션 1 + 2)

**벡터 검색** (올바른 피드백 찾기)과 **댓글 주입** (피드백 이해하기)을 결합하는 것을 권장합니다.

1.  **검색 (Search)**: `sentence-transformers`를 사용하여 가장 관련성 높은 과거 피드백을 찾습니다.
2.  **주입 (Inject)**:
    -   긍정적일 경우: "이 스타일을 따르세요: [답변]"
    -   부정적 + 댓글일 경우: "사용자 비판: [댓글]. 이것을 피하세요."
    -   부정적 (댓글 없음)일 경우: "이 응답을 피하세요: [답변]"

### 📅 구현 단계
1.  **DB 업데이트**: 벡터가 저장되는지 확인합니다 (또는 소규모 데이터셋의 경우 즉시 계산).
2.  **엔진 업데이트**: `faiss-cpu` 및 `sentence-transformers`를 `feedback_engine.py`에 통합합니다.
3.  **프롬프트 업데이트**: 댓글 기반 지침을 처리하도록 `ai_engine.py`를 수정합니다.

---

**검토 후 원하는 방향을 선택해 주세요.**
